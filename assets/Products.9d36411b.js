import{o as n,b as l,p as t,s as T,t as w,u as L,v as c,d as r,x as C,y as x,q as I,z as _,A as U,B as A,L as j,C as $,D as q,M as B,r as y,e as h}from"./vendor.7c20991a.js";import{a as f}from"./index.03ddc5cf.js";import{_ as S}from"./index.ad61d20f.js";import{C as D,F as V}from"./Form.a9cabf75.js";const F={props:{products:{type:Array,default:()=>[]},loadingStatus:{type:Object,default:()=>({loadingItem:{type:String,default:""}})}},setup(s,{emit:a}){return{openModal:e=>{a("getProduct",e)}}}},P=s=>(C("data-v-0c5b5b3c"),s=s(),x(),s),N={class:"prodsTable"},z={class:"row"},O={class:"col-12 col-sm-12"},E=P(()=>t("h5",null,"\u7522\u54C1\u5217\u8868",-1)),G=P(()=>t("hr",null,null,-1)),H={class:"table table-hover"},J=P(()=>t("thead",null,[t("tr",null,[t("th",null,"\u5716\u7247"),t("th",{scope:"col",class:"text-start"},"\u7522\u54C1\u540D\u7A31"),t("th",{scope:"col"},"\u50F9\u683C"),t("th",{scope:"col"},"\u64CD\u4F5C")])],-1)),K={style:{width:"200px"}},Q={class:"text-start"},R={key:0,class:"h5"},W={key:1,class:"h6"},X={key:2,class:"h5"},Y=["onClick","disabled"],Z={key:0,class:"spinner-border spinner-border-sm"},tt=I(" \u67E5\u770B\u66F4\u591A "),ot=["onClick","disabled"],dt={key:0,class:"spinner-border spinner-border-sm"},et=I(" \u52A0\u5230\u8CFC\u7269\u8ECA ");function at(s,a,d,e,b,p){return n(),l("div",N,[t("div",z,[t("div",O,[E,G,t("table",H,[J,t("tbody",null,[(n(!0),l(T,null,w(d.products,o=>(n(),l("tr",{key:o.id},[t("td",K,[t("div",{style:L([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${o.imageUrl})`}])},null,4)]),t("td",Q,c(o.title),1),t("td",null,[o.price?r("v-if",!0):(n(),l("div",R,c(o.origin_price)+" \u5143 ",1)),o.price?(n(),l("del",W,"\u539F\u50F9 "+c(o.origin_price)+" \u5143",1)):r("v-if",!0),o.price?(n(),l("div",X," \u73FE\u5728\u53EA\u8981 "+c(o.price)+" \u5143 ",1)):r("v-if",!0)]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm me-2 mb-md-1","data-bs-target":"#productModal","data-bs-toggle":"modal",onClick:g=>e.openModal(o.id),disabled:d.loadingStatus.loadingItem===o.id},[d.loadingStatus.loadingItem===o.id?(n(),l("span",Z)):r("v-if",!0),tt],8,Y),t("button",{type:"button",class:"btn btn-outline-danger btn-sm me-2 mb-md-1",onClick:g=>s.$emit("add-to-cart",o.id),disabled:d.loadingStatus.loadingItem===o.id},[d.loadingStatus.loadingItem===o.id?(n(),l("span",dt)):r("v-if",!0),et],8,ot)])]))),128))])])])])])}var st=S(F,[["render",at],["__scopeId","data-v-0c5b5b3c"]]);const nt={props:{product:{type:Object,default:()=>({imagesUrl:{type:Array,default:()=>[]},id:{type:String,default:""}})},loadingStatus:{type:Object,default:()=>({loadingItem:{type:String,default:""}})}},setup(s,{emit:a}){const d=_(1);return console.log(s.product),{qty:d}}},lt=s=>(C("data-v-e16bbad4"),s=s(),x(),s),rt={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},ct={class:"modal-dialog modal-xl",role:"document"},it={class:"modal-content border-0"},ut={class:"modal-header bg-dark text-white"},_t={class:"modal-title",id:"exampleModalLabel"},pt=lt(()=>t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),gt={class:"modal-body"},mt={class:"row"},bt={class:"col-sm-6"},vt=["src"],yt={class:"col-sm-6"},ht={class:"badge bg-primary rounded-pill"},ft={key:0,class:"h5"},St={key:1,class:"h6"},Pt={key:2,class:"h5"},kt={class:"input-group"};function Ct(s,a,d,e,b,p){return n(),l("div",rt,[t("div",ct,[t("div",it,[t("div",ut,[t("h5",_t,[t("span",null,c(d.product.title),1)]),pt]),t("div",gt,[t("div",mt,[t("div",bt,[t("img",{class:"img-fluid",src:d.product.imageUrl,alt:""},null,8,vt)]),t("div",yt,[t("span",ht,c(d.product.category),1),t("p",null,"\u5546\u54C1\u63CF\u8FF0\uFF1A"+c(d.product.description),1),t("p",null,"\u5546\u54C1\u5167\u5BB9\uFF1A"+c(d.product.content),1),d.product.price?r("v-if",!0):(n(),l("div",ft,c(d.product.origin_price)+" \u5143 ",1)),d.product.price?(n(),l("del",St,"\u539F\u50F9 "+c(d.product.origin_price)+" \u5143",1)):r("v-if",!0),d.product.price?(n(),l("div",Pt," \u73FE\u5728\u53EA\u8981 "+c(d.product.price)+" \u5143 ",1)):r("v-if",!0),t("div",null,[t("div",kt,[U(t("input",{type:"number",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=o=>e.qty=o),min:"1"},null,512),[[A,e.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:a[1]||(a[1]=o=>s.$emit("add-to-cart",d.product.id,e.qty))}," \u52A0\u5165\u8CFC\u7269\u8ECA ")])])]),r(" col-sm-6 end ")])])])])],512)}var xt=S(nt,[["render",Ct],["__scopeId","data-v-e16bbad4"]]);const It={components:{Loading:j,ProdModal:xt,ProdsTable:st,Carts:D,Form:V},name:"Products",setup(){const s=_(!1),a=_(!0),d=_([]),e=_({}),b=_({}),p=_(null),o=$({loadingItem:""});q(async()=>{s.value=!0,p.value=new B(document.getElementById("productModal"),{keyboard:!1}),g(),s.value=!1});const g=async()=>{try{const u=await f.products.getProductsAll();d.value=u.products}catch(u){alert(u.message)}};return{isLoading:s,fullPage:a,products:d,product:e,cart:b,loadingStatus:o,getProduct:async u=>{o.loadingItem=u;try{const m=await f.products.getProduct(u);o.loadingItem="",e.value=m.product}catch(m){alert(m.message)}},addToCart:async(u,m=1)=>{p.value.hide();try{o.loadingItem=u;const v={product_id:u,qty:m},M=await f.cart.addCart({data:v});alert(M.message),o.loadingItem=""}catch(v){alert(v.message)}}}}},Mt={class:"container"},Tt={class:"mt-4"};function wt(s,a,d,e,b,p){const o=y("Loading"),g=y("ProdsTable"),k=y("ProdModal");return n(),l("div",Mt,[t("div",Tt,[r(" Loading "),h(o,{active:e.isLoading,"onUpdate:active":a[0]||(a[0]=i=>e.isLoading=i),"is-full-page":e.fullPage},null,8,["active","is-full-page"]),r(" \u7522\u54C1\u5217\u8868 "),h(g,{products:e.products,"onUpdate:products":a[1]||(a[1]=i=>e.products=i),loadingStatus:e.loadingStatus,"onUpdate:loadingStatus":a[2]||(a[2]=i=>e.loadingStatus=i),onGetProduct:e.getProduct,onAddToCart:e.addToCart},null,8,["products","loadingStatus","onGetProduct","onAddToCart"]),r(' @get-cart="getCart" ')]),r(" Modal "),h(k,{product:e.product,"onUpdate:product":a[3]||(a[3]=i=>e.product=i),onAddToCart:e.addToCart,loadingStatus:e.loadingStatus,"onUpdate:loadingStatus":a[4]||(a[4]=i=>e.loadingStatus=i)},null,8,["product","onAddToCart","loadingStatus"])])}var $t=S(It,[["render",wt],["__scopeId","data-v-7b19cff0"]]);export{$t as default};
